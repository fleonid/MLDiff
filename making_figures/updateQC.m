function [dQ,dC]=updateQC(h)
%
 K=length(h)+1;
%
 if K<4
     disp(' '), fprintf('K = %i', K), 
     disp(' ERROR:  K must be bigger than 3 '), 
     disp(' '),
 end
% 
 dC=zeros(2,K);
%
 dC(1,K)=-h(K-2)^2/(6*(h(K-2)+h(K-1)));
 dC(1,K-1)=(h(K-2)^2*(h(K-3)+2*h(K-2)+h(K-1)))/(6*(h(K-3)+h(K-2))*(h(K-2)+h(K-1)));
 dC(1,K-2)=-h(K-2)^2/(6*(h(K-3)+h(K-2))); 
%
 dC(2,1)=1;
 dC(2,2)=-(3*h(1)^2+3*h(1)*h(2)+h(2)^2)/(6*(h(1)+h(2)));
 dC(2,3)=-(2*h(1)*h(2)+h(1)*h(3)+h(2)*h(3)+h(2)^2)/(6*(h(1)+h(2)));
%for i=4:K-2
%   dC(2,i)=-(h(i-2)+h(i-1)+h(i))/6;
%end
 dC(2,4:K-2)=-(h(2:K-4)+h(3:K-3)+h(4:K-2))/6; % new 
%dC1-dC, % new
%
 dC(2,K-1)=-(h(K-3)*h(K-2)+h(K-3)*h(K-1)+2*h(K-2)*h(K-1)+h(K-2)^2)/(6*(h(K-2)+h(K-1)));
 dC(2,K)=-(h(K-2)^2+3*h(K-2)*h(K-1)+3*h(K-1)^2)/(6*(h(K-2)+h(K-1)));
%
if K==4 
    dC(2,3)=dC(2,3)+h(1)^2/(6*(h(1) + h(2))); 
end
%
 dQ(1,1)=-(2*h(K-2))/(3*(h(K-3)+h(K-2))^2);
 dQ(1,2)=(h(K-2)*(h(K-3)+5*h(K-2)+4*h(K-1)))/(6*(h(K-3) + h(K-2))^2*(h(K-2) + h(K-1)));
 dQ(1,3)=-h(K-2)/(6*(h(K-3)+h(K-2))*(h(K-2)+h(K-1)));
%
 dQ(2,1)=(h(K-2)*(h(K-3) + 5*h(K-2) + 4*h(K-1)))/(6*(h(K-3) + h(K-2))^2*(h(K-2) + h(K-1)));
 dQ(2,2)=(h(K-2)^2+4*h(K-2)*h(K-1)+h(K-3)*h(K-2)+h(K-1)^2+3*h(K-3)*h(K-1))/(3*(h(K-3)+h(K-2))*(h(K-2)+h(K-1))^2)-(h(K-3)+3*h(K-2))/(3*(h(K-3)+h(K-2))^2);
 dQ(2,3)=-(2*h(K-3)*h(K-2)+6*h(K-3)*h(K-1)+5*h(K-2)*h(K-1)+h(K-2)^2)/(6*(h(K-3)+h(K-2))*(h(K-2)+h(K-1))^2);
%
 dQ(3,1)=-h(K-2)/(6*(h(K-3)+h(K-2))*(h(K-2)+h(K-1)));
 dQ(3,2)=-(2*h(K-3)*h(K-2)+6*h(K-3)*h(K-1)+5*h(K-2)*h(K-1)+h(K-2)^2)/(6*(h(K-3)+h(K-2))*(h(K-2)+h(K-1))^2);
 dQ(3,3)=(h(K-2)+3*h(K-1))/(3*(h(K-2)+h(K-1))^2);
%
return